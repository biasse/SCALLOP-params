#pragma once

#include <NTL/ZZ.h>
#include <vector>

#include "fp2.hpp"

const NTL::ZZ p = NTL::conv<NTL::ZZ>("4114534055211428858209763614504410563117701662267362937138137095586936058053761704842156133975358905714291000507768794648473124720678019767543502087984105654039860176528637932566910494321588571084727940922746613867782136100904100899254907911401022219784668284602450834434561264189531655905496525890573382474959042286886123544723208330612164409523725883983605918613518273414945403217222161064894795280154916448207951095491621077495805609660640803620150293725576124452440320886343175508418100084863559079428799766681877685071383771673711806607518344260958541082058104638843060207642392140545208993133008939248313207931109695817894592511");
const NTL::ZZ lampos = NTL::conv<NTL::ZZ>("1205794941487557338817933421586945351024768814661670785658311427689589012033869192016273739935809183967388006252240405091621900299263526317091679942798365976676737629375085072508815266329627853");
const NTL::ZZ lamneg = NTL::conv<NTL::ZZ>("1412970443851765635529985925689555099829072726553431131483688314861114903531396612132134034171272046947455092273733495645106478991766762985675934573657981153961144064626711799861572492875849821");

const NTL::ZZ A_re = NTL::conv<NTL::ZZ>("1760512960193285325006126313474674169262061248281515334798347661085520068262193081516785695086104738692036716055467540066663189936777745626944243301906179374994498872749726145992893681371484000111759352856006863546992087874236480684202857917574330840201412219296449398423669575415474381277458295196795430367567236094564218219704895863134451493878549583139572758891199013202780188240439394384894375604978037252901917900759258394361945311025730997104224694451535914074533250425915990232588421642930194871238207197136376978977793879629330934863132337879874240397340518861309506218829009956040336621629412673098999458168320079027906500480");
const NTL::ZZ A_im = NTL::conv<NTL::ZZ>("450475776345849033300638430199405705775910372350509022927242305482066275593648206687505262757582362072676772726546801413719078655341982735949489473959425936840129018318533192013903543929692183408853083683215385349394033738208409639856530645219412375735857519397298891427103664651181082102822068989401760722858353965868072904032350481063278250818979096357325408313294583635885822670236527938212244056834927965978081127082006678948734956510446148867677985339651254246833458909833432781260092813581238329825139421090624358738122861168478080285553602293723899382094733345180415766328468402520369418749034553173872743088296752510130172467");

const NTL::ZZ P_re =  NTL::conv<NTL::ZZ>("3336117575625769386630102222186278698028207860442618650870373002503781790586473700401305969019911528166469773014405678595895350862170987352516454732939793656299129079940100113300082617095938318710104754184989482649002629017183597847509255393388971555295052080807503387594140377622700990297953368941688571542966682640152030504219391910974162069080296450066925206072421163768826578496235772249782055519125356006148087485604520788126911691394788695837490448307199137090777877697006205408924537541910950655784998654547562364155358990611578313828114904497287043583070906731302238158951204534663629908003740606901164434133095085767286306723");
const NTL::ZZ P_im =  NTL::conv<NTL::ZZ>("332824903524734177865999776229660983653312156949178174856004554787393688685547897861105247129790279506836992618997220117878898942736046696277343820351792963498426724688575220410634548536413856989713412099047654844072113088860886421624765568322754731250531665690235006650864566517401739227493982376568391629547157402987968320043667359902157526540732858631510817665586659612759535783414262750124137209385662252611605543562330360610490443653814408266090979650362742962473911772051645002460787880541752799365465743462264487265589508559742797624788971312472310624530827610516586404249365356969279451334212402937311261634768406138513552937");
const NTL::ZZ Q_re =  NTL::conv<NTL::ZZ>("748906156123912213705599822127943392372858325432023038557964821820778568301818216139327678037922873091560888823511494653482691355887651420219700299281263453452831960040387121189373998976448637200673267826447567141650247779246981921664133477094726276825269695714137681562904942935205367846351565250696182110476243212945447731947974747991592431683174393941169952170126551563463013516375526412913621732768893009057450847778480648568918995785611555295431537796691684669550096363547566414702047885055808779466193436109164938882613052546164156108903860861039260819883379904816495218562394914022445542724242598922878841216091669435568236487");
const NTL::ZZ Q_im =  NTL::conv<NTL::ZZ>("1548274426962457620053316423439169000698505986624117491217446246709094015402656345433570018369638214777617252336837121004855100431430144402540073383251783776989894569742261731710005422212647024846950390190047243852293892994674781821419391188929319315021304994741571361699690148143522517322408013506854889171425907737114738132167229863922940136952076412445993018065023449411092070757702696123103502381667337192157573025067399757688775640208595900677660258550567252599203223838996181297888101048214514815257232157230277961107714128134949238507839130362950229186056561313519003351126701684212393656331063786361420282001084224249700040447");
const NTL::ZZ Qm_re =  NTL::conv<NTL::ZZ>("3610779507726968837290624134746603293356874316044318043666737972655014065991069615379753716188442787858042300078614381285980678424673454210851642228200692479696923225488711448141680954725704840374988445135011405248636328867677706524579050078169964090773943514985840200467930366925590568359096574139102109658395563485550689281093157377362568747093113958349179839253016296043148218408352565129935895255107703016083398647528010674321994329298893038790625104691738899320167825330805477420561093762977410454190304490173648482139715423295011719223254871251866371781183772554945198379411138879705787727561614209374010398535087059645691601532");
const NTL::ZZ Qm_im =  NTL::conv<NTL::ZZ>("2192160259636349744028055934662802170648067117586791051597634338792784357829521227334290774316322594628638811820940261868920910458614486290159535178601717079814234492714773129008537315151040302797590354051729287999289796720773776696107591458885953538482112693222184191479464543787872960425955563312244956427079457202621779489198538118878084153196721125198641672424198468420783115684280003073141958014436938696869595156286404939193027907613349526025360075420471471303061066330644159305396143738251263174709542122047279847773190391362016898786445292410066473809213888658423073988622306841546698304816326805420608395612638808425347216197");

const std::vector<int> ells{11, 23, 37, 47, 53, 59, 67, 73, 97, 103, 127, 131, 137, 139, 179, 193, 197, 223, 229, 233, 257, 269, 281, 283, 293, 313, 331, 347, 349, 353, 373, 383, 397, 419, 431, 443, 479, 491, 563, 577, 593, 601, 607, 613, 641, 647, 653, 659, 691, 727, 743, 751, 757, 761, 811, 821, 823, 829, 839, 857, 859, 877, 883, 887, 953, 983, 991, 997, 1031, 1061, 1063, 1069, 1087, 1093, 1097, 1129, 1163, 1171, 1181, 1187, 1217, 1223, 1229, 1231, 1237, 1259, 1277, 1279, 1289, 1319, 1321, 1361, 1367, 1373, 1409, 1423, 1433, 1459, 1471, 1511, 1531, 1553, 1567, 1571, 1579, 1601, 1619, 1627, 1637, 1657, 1663, 1669, 1709, 1723, 1747, 1783, 1811, 1823, 1831, 1847, 1861, 1871, 1889, 1907, 1913, 1933, 1979, 1993, 1997, 2053, 2081, 2083, 2089, 2111, 2141, 2153, 2203, 2207, 2237, 2251};
// 2 isog -> const std::vector<int> strat{256, 128, 64, 32, 17, 9, 5, 3, 2, 1, 1, 1, 1, 2, 1, 1, 1, 4, 2, 1, 1, 1, 2, 1, 1, 8, 4, 2, 1, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 16, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 32, 16, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 16, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 64, 32, 16, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 16, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 32, 16, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 16, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 128, 64, 32, 16, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 16, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 32, 16, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 16, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 64, 32, 16, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 16, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 32, 16, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 16, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1};
const std::vector<int> strat{157, 103, 58, 31, 16, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 15, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 7, 4, 2, 1, 1, 2, 1, 1, 3, 2, 1, 1, 1, 1, 27, 15, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 7, 4, 2, 1, 1, 2, 1, 1, 3, 2, 1, 1, 1, 1, 12, 7, 4, 2, 1, 1, 2, 1, 1, 3, 2, 1, 1, 1, 1, 5, 3, 2, 1, 1, 1, 1, 2, 1, 1, 1, 45, 27, 15, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 7, 4, 2, 1, 1, 2, 1, 1, 3, 2, 1, 1, 1, 1, 12, 7, 4, 2, 1, 1, 2, 1, 1, 3, 2, 1, 1, 1, 1, 5, 3, 2, 1, 1, 1, 1, 2, 1, 1, 1, 18, 12, 7, 4, 2, 1, 1, 2, 1, 1, 3, 2, 1, 1, 1, 1, 5, 3, 2, 1, 1, 1, 1, 2, 1, 1, 1, 8, 4, 2, 2, 1, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 71, 38, 21, 12, 7, 4, 2, 1, 1, 2, 1, 1, 3, 2, 1, 1, 1, 1, 5, 3, 2, 1, 1, 1, 1, 2, 1, 1, 1, 9, 5, 3, 2, 1, 1, 1, 1, 2, 1, 1, 1, 4, 2, 1, 1, 1, 2, 1, 1, 17, 9, 5, 3, 2, 1, 1, 1, 1, 2, 1, 1, 1, 4, 2, 1, 1, 1, 2, 1, 1, 8, 4, 2, 1, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 33, 17, 9, 5, 3, 2, 1, 1, 1, 1, 2, 1, 1, 1, 4, 2, 1, 1, 1, 2, 1, 1, 8, 4, 2, 1, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 16, 8, 4, 2, 1, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1};
const int dim = 75;
const int N_ball = 20;
const int e = 762;