#pragma once

#include <NTL/ZZ.h>
#include <vector>

#include "fp2.hpp"

const NTL::ZZ p = NTL::conv<NTL::ZZ>("4114534055211428858209763614504410563117701662267362937138137095586936058053761704842156133975358905714291000507768794648473124720678019767543502087984105654039860176528637932566910494321588571084727940922746613867782136100904100899254907911401022219784668284602450834434561264189531655905496525890573382474959042286886123544723208330612164409523725883983605918613518273414945403217222161064894795280154916448207951095491621077495805609660640803620150293725576124452440320886343175508418100084863559079428799766681877685071383771673711806607518344260958541082058104638843060207642392140545208993133008939248313207931109695817894592511");
const NTL::ZZ lampos = NTL::conv<NTL::ZZ>("36250324818012496129712895418439094745193345670829707448149457903532893198786227980333398617035379684044736446971108613126375417066289449721534215168174091554570326173584276903970970838351665911471863120622104479468727830741446229545759395132136945421564905406854697512364141420512638703194577547078646422458509725301924696791941819998742674362515157387762027085555600175142038515423866152571566794842");
const NTL::ZZ lamneg = NTL::conv<NTL::ZZ>("114921588007317120166843819178311289148366549327323132634021757808015303915164323216634361239541528863577487560463896887759285562635642477214622692072825140208111282587139243138082819351639472094255363664090056677860387275472898846237596191276152343337586402614790902426727986014386986667646684863176267861056316215866036716796611380079618042740795502134983730989431056503724597928866987741241911691035");

const NTL::ZZ A_re = NTL::conv<NTL::ZZ>("1760512960193285325006126313474674169262061248281515334798347661085520068262193081516785695086104738692036716055467540066663189936777745626944243301906179374994498872749726145992893681371484000111759352856006863546992087874236480684202857917574330840201412219296449398423669575415474381277458295196795430367567236094564218219704895863134451493878549583139572758891199013202780188240439394384894375604978037252901917900759258394361945311025730997104224694451535914074533250425915990232588421642930194871238207197136376978977793879629330934863132337879874240397340518861309506218829009956040336621629412673098999458168320079027906500480");
const NTL::ZZ A_im = NTL::conv<NTL::ZZ>("450475776345849033300638430199405705775910372350509022927242305482066275593648206687505262757582362072676772726546801413719078655341982735949489473959425936840129018318533192013903543929692183408853083683215385349394033738208409639856530645219412375735857519397298891427103664651181082102822068989401760722858353965868072904032350481063278250818979096357325408313294583635885822670236527938212244056834927965978081127082006678948734956510446148867677985339651254246833458909833432781260092813581238329825139421090624358738122861168478080285553602293723899382094733345180415766328468402520369418749034553173872743088296752510130172467");

const NTL::ZZ P_re =  NTL::conv<NTL::ZZ>("3336117575625769386630102222186278698028207860442618650870373002503781790586473700401305969019911528166469773014405678595895350862170987352516454732939793656299129079940100113300082617095938318710104754184989482649002629017183597847509255393388971555295052080807503387594140377622700990297953368941688571542966682640152030504219391910974162069080296450066925206072421163768826578496235772249782055519125356006148087485604520788126911691394788695837490448307199137090777877697006205408924537541910950655784998654547562364155358990611578313828114904497287043583070906731302238158951204534663629908003740606901164434133095085767286306723");
const NTL::ZZ P_im =  NTL::conv<NTL::ZZ>("332824903524734177865999776229660983653312156949178174856004554787393688685547897861105247129790279506836992618997220117878898942736046696277343820351792963498426724688575220410634548536413856989713412099047654844072113088860886421624765568322754731250531665690235006650864566517401739227493982376568391629547157402987968320043667359902157526540732858631510817665586659612759535783414262750124137209385662252611605543562330360610490443653814408266090979650362742962473911772051645002460787880541752799365465743462264487265589508559742797624788971312472310624530827610516586404249365356969279451334212402937311261634768406138513552937");
const NTL::ZZ Q_re =  NTL::conv<NTL::ZZ>("748906156123912213705599822127943392372858325432023038557964821820778568301818216139327678037922873091560888823511494653482691355887651420219700299281263453452831960040387121189373998976448637200673267826447567141650247779246981921664133477094726276825269695714137681562904942935205367846351565250696182110476243212945447731947974747991592431683174393941169952170126551563463013516375526412913621732768893009057450847778480648568918995785611555295431537796691684669550096363547566414702047885055808779466193436109164938882613052546164156108903860861039260819883379904816495218562394914022445542724242598922878841216091669435568236487");
const NTL::ZZ Q_im =  NTL::conv<NTL::ZZ>("1548274426962457620053316423439169000698505986624117491217446246709094015402656345433570018369638214777617252336837121004855100431430144402540073383251783776989894569742261731710005422212647024846950390190047243852293892994674781821419391188929319315021304994741571361699690148143522517322408013506854889171425907737114738132167229863922940136952076412445993018065023449411092070757702696123103502381667337192157573025067399757688775640208595900677660258550567252599203223838996181297888101048214514815257232157230277961107714128134949238507839130362950229186056561313519003351126701684212393656331063786361420282001084224249700040447");
const NTL::ZZ Qm_re =  NTL::conv<NTL::ZZ>("1841376517530690604331030502638203985070493761402874939236609249857120689338294510551723540759540970184417761904012897931041619921441999706956995497654530342482622754932133157470331446519976026487749828110134661933558859194694313357341577395253654629220417317564687865041001831045231858681706469793506996303394475247457212197883328048634758773784958215863317948063406551712200269642310317079360834279136668960401948090267712519738041700143443513670651837696466219132986802142102159576943768788357470819008193917927188722017229168335520011956563309193058370370265662243098062827262579862777461528762729563800161786494630441241260158478");
const NTL::ZZ Qm_im =  NTL::conv<NTL::ZZ>("1299154417911174869649081245137825218425386421939950264255321902213541220973232007262822753340621271758669637092809256231606758665037456559575544904924603764600475640035601021143795050707578444363406040225030639027519579055340196764196180229367498143166184382638076528923880273591980697044046910333434782811631713614655749826979256763276249204814488112681372134657367776757940391356008842148369880501999311255151913221006117406340277871459541484496292763966204758606870206951275172210082872539384685524575909478052450507428068552131580894203575245197711952243267829286299264752042102729379079508564971680181208020718388973228584890787");

const std::vector<int> ells{11, 23, 37, 47, 53, 59, 67, 73, 97, 103, 127, 131, 137, 139, 179, 193, 197, 223, 229, 233, 257, 269, 281, 283, 293, 313, 331, 347, 349, 353, 373, 383, 397, 419, 431, 443, 479, 491, 563, 577, 593, 601, 607, 613, 641, 647, 653, 659, 691, 727, 743, 751, 757, 761, 811, 821, 823, 829, 839, 857, 859, 877, 883, 887, 953, 983, 991, 997, 1031, 1061, 1063, 1069, 1087, 1093, 1097, 1129, 1163, 1171, 1181, 1187, 1217, 1223, 1229, 1231, 1237, 1259, 1277, 1279, 1289, 1319, 1321, 1361, 1367, 1373, 1409, 1423, 1433, 1459, 1471, 1511, 1531, 1553, 1567, 1571, 1579, 1601, 1619, 1627, 1637, 1657, 1663, 1669, 1709, 1723, 1747, 1783, 1811, 1823, 1831, 1847, 1861, 1871, 1889, 1907, 1913, 1933, 1979, 1993, 1997, 2053, 2081, 2083, 2089, 2111, 2141, 2153, 2203, 2207, 2237, 2251};
// 2 isog -> const std::vector<int> strat{256, 128, 64, 32, 17, 9, 5, 3, 2, 1, 1, 1, 1, 2, 1, 1, 1, 4, 2, 1, 1, 1, 2, 1, 1, 8, 4, 2, 1, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 16, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 32, 16, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 16, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 64, 32, 16, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 16, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 32, 16, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 16, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 128, 64, 32, 16, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 16, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 32, 16, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 16, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 64, 32, 16, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 16, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 32, 16, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 16, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1};
const std::vector<int> strat{157, 103, 58, 31, 16, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 15, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 7, 4, 2, 1, 1, 2, 1, 1, 3, 2, 1, 1, 1, 1, 27, 15, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 7, 4, 2, 1, 1, 2, 1, 1, 3, 2, 1, 1, 1, 1, 12, 7, 4, 2, 1, 1, 2, 1, 1, 3, 2, 1, 1, 1, 1, 5, 3, 2, 1, 1, 1, 1, 2, 1, 1, 1, 45, 27, 15, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 7, 4, 2, 1, 1, 2, 1, 1, 3, 2, 1, 1, 1, 1, 12, 7, 4, 2, 1, 1, 2, 1, 1, 3, 2, 1, 1, 1, 1, 5, 3, 2, 1, 1, 1, 1, 2, 1, 1, 1, 18, 12, 7, 4, 2, 1, 1, 2, 1, 1, 3, 2, 1, 1, 1, 1, 5, 3, 2, 1, 1, 1, 1, 2, 1, 1, 1, 8, 4, 2, 2, 1, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 71, 38, 21, 12, 7, 4, 2, 1, 1, 2, 1, 1, 3, 2, 1, 1, 1, 1, 5, 3, 2, 1, 1, 1, 1, 2, 1, 1, 1, 9, 5, 3, 2, 1, 1, 1, 1, 2, 1, 1, 1, 4, 2, 1, 1, 1, 2, 1, 1, 17, 9, 5, 3, 2, 1, 1, 1, 1, 2, 1, 1, 1, 4, 2, 1, 1, 1, 2, 1, 1, 8, 4, 2, 1, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 33, 17, 9, 5, 3, 2, 1, 1, 1, 1, 2, 1, 1, 1, 4, 2, 1, 1, 1, 2, 1, 1, 8, 4, 2, 1, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 16, 8, 4, 2, 1, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1, 8, 4, 2, 1, 1, 2, 1, 1, 4, 2, 1, 1, 2, 1, 1};
const int dim = 140;
const int N_ball = 20;
const int e = 762;